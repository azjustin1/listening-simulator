<div class="container">
  <div class="container--left">
    @for (question of data.questions; track $index) {
      <div class="paragraph">
        <div class="input-answer">
          @if (!isTesting) {
            <mat-form-field style="width: 100%">
              <mat-select
                [disabled]="!mapEdittingById[question.id]"
                [(ngModel)]="question.correctAnswer"
              >
                @for (answer of data.answers; track $index) {
                  <mat-option [value]="answer.id">
                    {{ answer.content }}
                  </mat-option>
                }
              </mat-select>
            </mat-form-field>
          } @else {
            <div
              [id]="question.id"
              class="answer-drop-container"
              (dragover)="onDragOver($event, question.id)"
              (dragleave)="removeDropOver($event, question.id)"
              (drop)="onDropAnswer($event, question.id)"
            >
              <div
                class="answer-drop"
                draggable="true"
                (dragstart)="
                  onDragStart($event, data.questions[$index].answer.toString())
                "
              >
                {{
                  (
                    this.data.questions[$index].answer
                    | choiceContent: data.answers!
                  )?.content ?? ""
                }}
              </div>
            </div>
          }
        </div>
        <div class="input-reading">
          @if (mapEdittingById[question.id]) {
            <angular-editor
              class="editor"
              name="questionContent"
              [id]="question.id"
              [(ngModel)]="question.content"
              (ngModelChange)="onPaste($event)"
              [config]="config"
            ></angular-editor>
          } @else {
            @if (data) {
              <span
                class="reading-content"
                [innerHTML]="question.content"
              ></span>
            }
          }
        </div>
        @if (!isSaved && !isTesting && !isReadOnly) {
          <div class="question-actions">
            <button
              mat-button
              color="primary"
              (click)="editContent(question.id)"
            >
              <mat-icon>
                @if (mapEdittingById[question.id]) {
                  save
                } @else {
                  edit
                }
              </mat-icon>
            </button>
            <button mat-button color="warn" (click)="removeParagraph($index)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        }
      </div>
    }
    @if (!isSaved && !isTesting && !isReadOnly) {
      <button mat-raised-button (click)="addParagraph()">
        <mat-icon>add</mat-icon> Add Paragraph
      </button>
    }
  </div>
  <!-- Container right -->
  <div
    id="container-right"
    class="container--right"
    [ngClass]="{ testing: isTesting }"
    (drop)="onAnswerBackDrop($event)"
    (dragover)="onAnswerBackDragOver($event)"
    (dragleave)="onAnswerBackDragLeave($event)"
  >
    @for (answer of answers(); track $index) {
      <div class="answer">
        @if (mapEdittingById[answer.id]) {
          <mat-form-field class="heading-input">
            <mat-label>Content</mat-label>
            <textarea matInput [(ngModel)]="answer.content"></textarea>
          </mat-form-field>
        } @else {
          <mat-card
            class="answer"
            [draggable]="isTesting"
            (dragstart)="onDragStart($event, answer.id)"
          >
            <mat-card-content>
              {{ answer.content }}
            </mat-card-content>
          </mat-card>
        }
        @if (!isSaved && !isTesting && !isReadOnly) {
          <div class="question-actions">
            <button mat-button color="primary" (click)="editContent(answer.id)">
              <mat-icon>
                @if (mapEdittingById[answer.id]) {
                  save
                } @else {
                  edit
                }
              </mat-icon>
            </button>
            <button mat-button color="warn" (click)="removeAnswer($index)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        }
      </div>
    }
    @if (!isSaved && !isTesting && !isReadOnly) {
      <button class="add-answer-button" mat-raised-button (click)="addAnswer()">
        <mat-icon>add</mat-icon> Add Header
      </button>
    }
  </div>
</div>
