<div class="container">
  <h1>Create Quiz</h1>
  <div class="form-group">
    <mat-form-field>
      <mat-label>Quiz Name</mat-label>
      <input
        autocomplete="off"
        matInput
        name="quizName"
        type="text"
        class="form-control"
        id="quizName"
        [(ngModel)]="currentQuiz.name"
        required
      />
    </mat-form-field>
  </div>

  <div class="form-group">
    <mat-form-field>
      <mat-label>Time</mat-label>
      <input
        autocomplete="off"
        placeholder="Minute"
        matInput
        name="timeout"
        type="number"
        class="form-control"
        id="timeout"
        [(ngModel)]="currentQuiz.timeout"
        required
      />
    </mat-form-field>

    <mat-tab-group animationDuration="0ms">
      <mat-tab label="Listening">
        <ng-template matTabContent>
          @for (part of currentQuiz.listeningParts; track part.id) {
            <mat-card style="margin-top: 16px" appearance="outlined">
              <mat-card-content>
                <div>
                  <app-listening
                    [data]="part"
                    [isSaved]="mapSavedPart[part.id!]"
                  ></app-listening>
                </div>
                <div class="actions">
                  @if (mapSavedPart[part.id!]) {
                    <button
                      mat-button
                      color="primary"
                      type="button"
                      class="btn btn-danger"
                      (click)="onEditClick(part.id!)"
                    >
                      <mat-icon>edit</mat-icon> Edit part
                    </button>
                  } @else {
                    <button
                      mat-button
                      color="primary"
                      type="button"
                      class="btn btn-danger"
                      (click)="onSavePart(part.id!)"
                    >
                      <mat-icon>save</mat-icon> Save
                    </button>
                  }
                  <button
                    mat-button
                    color="warn"
                    type="button"
                    class="btn btn-danger"
                    (click)="removeListeningPart($index)"
                  >
                    <mat-icon>delete</mat-icon> Remove part
                  </button>
                </div>
              </mat-card-content>
            </mat-card>
          }
          <div class="add-button">
            <button
              mat-button
              color="primary"
              (click)="onAddListeningPart()"
              style="margin-top: 16px"
            >
              <mat-icon>add</mat-icon> Add part
            </button>
          </div>
        </ng-template>
      </mat-tab>
      <mat-tab label="Reading">
        <ng-template matTabContent>
          @for (part of currentQuiz.readingParts; track part.id) {
            <mat-card style="margin-top: 16px" appearance="outlined">
              <mat-card-content>
                <div class="reading-container">
                  <app-reading
                    [data]="part"
                    [isSaved]="mapSavedPart[part.id!]"
                  ></app-reading>
                  <div class="actions">
                    <button
                      mat-button
                      color="warn"
                      type="button"
                      class="btn btn-danger"
                      (click)="removeReadingPart($index)"
                    >
                      <mat-icon>delete</mat-icon> Remove part
                    </button>
                    @if (mapSavedPart[part.id!]) {
                      <button
                        mat-button
                        color="primary"
                        type="button"
                        class="btn btn-danger"
                        (click)="onEditClick(part.id!)"
                      >
                        <mat-icon>edit</mat-icon> Edit part
                      </button>
                    } @else {
                      <button
                        mat-button
                        color="primary"
                        type="button"
                        class="btn btn-danger"
                        (click)="onSavePart(part.id!)"
                      >
                        <mat-icon>save</mat-icon> Save
                      </button>
                    }
                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          }
          <div class="add-button">
            <button
              mat-button
              color="primary"
              (click)="onAddReadingParagraph()"
              style="margin-top: 16px"
            >
              <mat-icon>add</mat-icon> Add part
            </button>
          </div>
        </ng-template>
      </mat-tab>
      <mat-tab label="Writing">
        <ng-template matTabContent>
          @for (part of currentQuiz.writingParts; track part.id) {
            <mat-card style="margin-top: 16px" appearance="outlined">
              <mat-card-content>
                <app-writing
                  [data]="part"
                  [isSaved]="mapSavedPart[part.id!]"
                ></app-writing>
                <div class="actions">
                  @if (mapSavedPart[part.id!]) {
                    <button
                      mat-button
                      color="primary"
                      type="button"
                      class="btn btn-danger"
                      (click)="onEditClick(part.id!)"
                    >
                      <mat-icon>edit</mat-icon> Edit part
                    </button>
                  } @else {
                    <button
                      mat-button
                      color="primary"
                      type="button"
                      class="btn btn-danger"
                      (click)="onSavePart(part.id!)"
                    >
                      <mat-icon>save</mat-icon> Save part
                    </button>
                  }
                  <button
                    mat-button
                    color="warn"
                    type="button"
                    class="btn btn-danger"
                    (click)="remoteWritingPart($index)"
                  >
                    <mat-icon>delete</mat-icon> Remove part
                  </button>
                </div>
              </mat-card-content>
            </mat-card>
          }
          <div class="add-button">
            <button
              mat-button
              color="primary"
              (click)="onAddWritingParagraph()"
              style="margin-top: 16px"
            >
              <mat-icon>add</mat-icon> Add part
            </button>
          </div>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>

<div class="save-button">
  <button mat-raised-button color="primary" (click)="onSaveClick()">
    Save and Quit
  </button>
</div>
