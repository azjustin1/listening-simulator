<form>
  <div class="question-group">
    <div class="form-group">
      @if (isEditing) {
        <angular-editor
          name="questionContent"
          [id]="question._id!"
          [config]="config"
          [(ngModel)]="question.content"
          (ngModelChange)="onPaste($event)"
        ></angular-editor>
      } @else {
        <span [innerHTML]="question.content"> </span>
      }
      @if (isReadOnly && question.answer.length === 0) {
        ‚ùå
      }
    </div>

    <div class="choice-group">
      @if (isReadOnly) {
        <div class="choice">
          @if (question | isCorrectDropdown) {
            <span class="answer">
              {{ question | answerChoice }}
            </span>
          } @else {
            <span class="answer incorrect">
              {{ question | answerChoice }}
            </span>
            <span class="answer correct">
              {{ question | correctAnswerChoice }}
            </span>
          }
        </div>
      } @else {
        @if (isEditing) {
          @for (choice of question.choices; track $index) {
            <div class="choice">
              <div class="form-group">
                <mat-radio-group
                  [value]="question.correctAnswer[0]"
                  (change)="onSelectCorrectAnswer($event)"
                  name="correctAnswer"
                >
                  <mat-radio-button color="primary" [value]="choice._id">
                  </mat-radio-button>
                </mat-radio-group>
                <mat-form-field class="choice-input">
                  <textarea
                    autocomplete="off"
                    [disabled]="isReadOnly"
                    matInput
                    [name]="choice._id!"
                    type="text"
                    class="form-control"
                    [(ngModel)]="choice.content"
                  ></textarea>
                </mat-form-field>
                <button
                  mat-button
                  color="warn"
                  type="button"
                  class="btn btn-danger"
                  (click)="removeChoice(choice._id!, $index)"
                >
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          }
        } @else {
          @if (isTesting) {
            <mat-form-field class="choice-input">
              <mat-select [(value)]="question.answer">
                @for (choice of question.choices; track $index) {
                  <mat-option [value]="choice._id">{{
                    choice.content
                  }}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          } @else {
            <mat-form-field class="choice-input">
              <mat-select
                [disabled]="!isEditing"
                [(value)]="question.correctAnswer[0]"
                (selectionChange)="onSelectChange($event)"
              >
                @for (choice of question.choices; track $index) {
                  <mat-option [value]="choice._id">{{
                    choice.content
                  }}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          }
        }
      }
    </div>
    @if (isEditing) {
      <button
        mat-button
        color="primary"
        type="button"
        class="btn btn-primary"
        (click)="addChoice(question)"
      >
        <mat-icon>add</mat-icon>
        More option
      </button>
    }
  </div>
</form>
